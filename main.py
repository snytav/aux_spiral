# -*- coding: utf-8 -*-
"""aux_spiral_plots.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1O8Nrl2WotQXvL6KYMY3lliaCVymUd5Oi
"""

from sympy import *
from sympy.functions import besseli,besselj
r,th = symbols('r th')
#y = exp(-r)*sin(th)

def polar2cartesian_expr(polar_expr):
    x,y = symbols('x y')
    exp_no_r = polar_expr.subs(r,sqrt(x*x+y*y))
    exp_cart = exp_no_r.subs(th,atan2(y,x))
    return exp_cart








# c_x = c.subs(x,1.0)
# print(c.subs(x,xx[1])) #.subs(y,Y[1]).evalf()
# #c_x

def compute_matrix_by_symbolic(c,xx,yy):
    Z = np.zeros((xx.shape[0],yy.shape[0]))
    for i,xr in enumerate(xx):
        for j,yr in enumerate(yy):
            t = c.subs(x,xr).subs(y,yr).evalf()
            Z[i][j] = t
    return Z

def draw3D_surface(xx,yy,Z,ax,fig_title):
    import matplotlib.pyplot as plt
    import numpy as np

    from matplotlib import cm
    from matplotlib.ticker import LinearLocator



    # Make data.
    #X = np.arange(-5, 5, 0.25)
    #Y = np.arange(-5, 5, 0.25)
    X, Y = np.meshgrid(xx,yy)
    #R = np.sqrt(X**2 + Y**2)
    #Z = np.sin(R)
    print(X.shape)
    print(Z.shape)

    # Plot the surface.
    ax.azim = -147.07792207792212
    ax.dist = 10
    ax.elev = 24.642857142856997

    surf = ax.plot_surface(X, Y, Z, cmap=cm.coolwarm,
                          linewidth=0, antialiased=False)
    # surf = ax.contour(X, Y, Z, cmap=cm.coolwarm,
    #                        linewidth=0, antialiased=False)
    ax.set_xlabel('X')
    ax.set_ylabel('Y')
    ax.set_zlabel('Z')
    plt.title(fig_title)
    # Customize the z axis.
    #ax.set_zlim(-1.01, 1.01)
    #ax.zaxis.set_major_locator(LinearLocator(10))
    # A StrMethodFormatter is used automatically
    #ax.zaxis.set_major_formatter('{x:.02f}')

    # Add a color bar which maps values to colors.
    fig.colorbar(surf, shrink=0.5, aspect=5)

    plt.show()
#draw3D_surface(xx,yy,Z)

def normal_pdf(x, mean, var):
    return np.exp(-(x - mean) ** 2 / (2 * var))

def draw_contour(X,Y,Z):
    import matplotlib.pyplot as plt
    import numpy as np

    fig = plt.figure(figsize=(6, 5))
    left, bottom, width, height = 0.1, 0.1, 0.8, 0.8
    ax = fig.add_axes([left, bottom, width, height])

    start, stop, n_values = -8, 8, 800

    x_vals = np.linspace(start, stop, n_values)
    y_vals = np.linspace(start, stop, n_values)
    #X, Y = np.meshgrid(x_vals, y_vals)

# = np.sqrt(X ** 2 + Y ** 2)

    cp = plt.contourf(X, Y, Z)
    plt.colorbar(cp)

    ax.set_title('Contour Plot')
    ax.set_xlabel('x (cm)')
    ax.set_ylabel('y (cm)')
    plt.show()

import numpy as np
N = 100

rr = np.linspace(0,15,N)
pp = np.linspace(0,2*np.pi,N)
#yy = [y.subs(r,xr).subs(th,xp).evalf() for xr in rr for xp in pp]

#yy = np.array(yy)
# yy = yy.reshape(N,N)

#polar_plot(rr,pp,yy,'yy','QQ')

#"""![bessel.png](data:image/png;base64,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)"""

import matplotlib.pyplot as plt
#plt.plot(rr,yy)

def substitute_spiral_constants(expr,z_n,k_n,Bc_n,z0_n,kc_n):
     exp_s = expr.subs(z,z_n).subs(k,k_n).subs(Bc,Bc_n).subs(z0,z0_n).subs(kc,kc_n)
     return exp_s

def evaluate_on_circle(expr,rr,pp):
    ev_expr = [expr.subs(r,xr).subs(th,xp) for xr,xp in zip(rr,pp)]
    arr = np.array(ev_expr)

# from sympy import *
# r,th = symbols ('r th')
# y = np.exp(-r)*sin(th)

def multiplot_expressions(expr,rr,pp,tit):
    fig, axs = plt.subplots(3, 3)
    axs[0, 0].plot(x, y)
    axs[0, 0].set_title('Axis [0, 0]')
    axs[0, 1].plot(x, y, 'tab:orange')
    axs[0, 1].set_title('Axis [0, 1]')
    axs[1, 0].plot(x, -y, 'tab:green')
    axs[1, 0].set_title('Axis [1, 0]')
    axs[1, 1].plot(x, -y, 'tab:red')
    axs[1, 1].set_title('Axis [1, 1]')


if __name__ == '__main__':


    import numpy as np
    rm = 0.08
    N = 100
    xx = np.linspace(-rm, rm, N)
    yy = np.linspace(-rm, rm, N)
    x, y,r,th = symbols('x y r th')
    polar_expr = exp(-r) * sin(th)
    c = polar2cartesian_expr(polar_expr)
    # compute 2D matrix by functiom
    m_c = compute_matrix_by_symbolic(c, xx, yy)
    # draw 2D matrix
    fig, ax = plt.subplots(subplot_kw={"projection": "3d"})
    draw3D_surface(xx, yy, m_c,ax,"example")

    qq = 0
    #define function doing that